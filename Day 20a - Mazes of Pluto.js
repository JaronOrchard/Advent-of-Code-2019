function day20(rows, cols, input) {
  // NOTE: Must pad all edges of the input list to make this work.
  
  // Make a list of all the portals, their names, and their coordinates
  // Do a BFS starting at AA:
  //   If at a portal, add neighboring portal spot to list
  //   If you add a spot that's already been visited but you have a lower number, continue it, otherwise stop
  
  var portalList = {};
  for (var i = 0; i < input.length; i++) {
    if (input[i] >= "A" && input[i] <= "Z") {
      var portalName, openSpace;
      var matched = false;
      if (input[i+1] >= "A" && input[i+1] <= "Z") {
        matched = true;
        portalName = input[i] + input[i+1];
        if (input[i-1] === ".") openSpace = i-1;
        else if (input[i+2] === ".") openSpace = i+2;
      } else if (input[i+cols] >= "A" && input[i+cols] <= "Z") {
        matched = true;
        portalName = input[i] + input[i+cols];
        if (input[i-cols] === ".") openSpace = i-cols;
        else if (input[i+cols+cols] === ".") openSpace = i+cols+cols;
      }
      if (matched) {
        if (!portalList.hasOwnProperty(portalName)) {
          portalList[portalName] = [openSpace];
        } else {
          portalList[portalName].push(openSpace);
        }
      }
    }
  }
  
  // Start from AA and do a BFS:
  var map = {};
  var cellsToCheck = [];
  cellsToCheck.push({"index": portalList["AA"][0], "dist": 0});
  while (cellsToCheck.length > 0) {
    var cell = cellsToCheck[0];
    cellsToCheck = cellsToCheck.slice(1);
    
    if (!map.hasOwnProperty(cell.index) || map[cell.index] > cell.dist) {
      
      //console.log("Checking index " + cell.index + " at dist " + cell.dist);
      map[cell.index] = cell.dist;
      
      // Add all four neighbors if passable spots
      for (var i = 0; i < 4; i++) {
        var neighborIndex;
        if (i === 0) neighborIndex = cell.index + 1; // Right
        if (i === 1) neighborIndex = cell.index - 1; // Left
        if (i === 2) neighborIndex = cell.index + cols; // Down
        if (i === 3) neighborIndex = cell.index - cols; // Up
        
        if (input[neighborIndex] === ".") {
          cellsToCheck.push({"index": neighborIndex, "dist": cell.dist + 1});
        }
        if (input[neighborIndex] >= "A" && input[neighborIndex] <= "Z") {
          // It's a portal, find the matching spot
          for (key in portalList) {
            if (key !== "AA" && key !== "ZZ") { // Not portals
              var portalSpots = portalList[key];
              if (cell.index === portalSpots[0]) {
                //console.log("Adding exit of " + key + " at dist " + (cell.dist + 1));
                cellsToCheck.push({"index": portalSpots[1], "dist": cell.dist + 1});
              } else if (cell.index === portalSpots[1]) {
                //console.log("Adding exit of " + key + " at dist " + (cell.dist + 1));
                cellsToCheck.push({"index": portalSpots[0], "dist": cell.dist + 1});
              }
            }
          }
        }
      }
    }
  }
  
  console.log(map);
  console.log(portalList);
  console.log("done: " + map[portalList["ZZ"][0]]);
}
//day20(21, 22, "                               A                     A              #######.#########     #######.........#     #######.#######.#     #######.#######.#     #######.#######.#     #####  B    ###.#   BC...##  C    ###.#     ##.##       ###.#     ##...DE  F  ###.#     #####    G  ###.#     #########.#####.#   DE..#######...###.#     #.#########.###.#   FG..#########.....#     ###########.#####                Z                     Z                             ");
day20(121, 125, "                                                                                                                                                                       W     P     B       T           P   K                                                                                        L     W     W       Z           S   S                                                 #######################################.#####.#####.#######.###########.###.###########################################      #.........#.............#...#.#...#.#.......#.#.#.........#.#...#...#.....#...#.............#...#...#.....#...#...#.#.#      #####.#######.#.#######.#.###.###.#.###.#.#.#.#.###.#######.#.#####.#####.#.###.#####.#.###.###.#.###.###.###.#.###.#.#      #...........#.#.#.....#.#.#.#.#.#.....#.#.#.#.....#.....#.....#...#.......#.........#.#.#...#.....#.....#.#...#.....#.#      #.###.#.#.#####.###.#.#.#.#.#.#.#.#.#.###.#####.###.#####.###.#.###.#.#####.#########.#.#######.###.###.#####.#.#.###.#      #.#...#.#.#.#...#...#...........#.#.#.......#...#.....#.#.#.....#...#.#...#.....#...#.#.#.....#...#.#.#.#...#...#.#...#      ###.###.###.#########.###.#.###.###.#####.#####.#.#.###.###.###.###.###.#.#.###.#.#######.#####.###.#.###.#####.#####.#      #.#.#.#.....#.#...#.#.#...#.#...........#.#.....#.#.#.#.#...#.#.#.......#.#.#...#.#.#...#...#.....#.#.#.......#...#...#      #.###.###.###.###.#.#####.###.#.###.###.#####.#####.#.#.###.#.###.#######.#.#####.#.###.#.#####.###.#.#.###.###.#####.#      #.#.#.......#...............#.#.#.....#.#.....#...#.......#...#.#.#.....#.#...#...#.#.....#...#.#...#...#...#...#.....#      #.#.#.###.###.#######.#.#.#########.#####.#.###.#####.#.###.###.#####.#.#.#.#####.#.#.#####.###.#.###.#########.###.###      #.......#...#.#.....#.#.#...#.#...#...#...#.....#.#...#.#.........#...#...#.#.................#.......#.#.#.......#...#      #.###.#.#########.#####.#####.###.#.#####.#.#.###.#.#.#######.#######.#.###.#####.###.#.#######.#######.#.#####.###.###      #...#.#...#.#.....#.......#.....#.#...#.#.#.#.....#.#.#.#.....#.#.....#.#...#.#.....#.#.#.#.....#.......#.#.....#...#.#      #.###.#####.#####.#.###.#######.#.###.#.###.#.###.#.###.###.#.#.###.###.###.#.###.#######.###.#####.#####.#.#######.#.#      #.#.#.#.....#.#...#.#.#.#.#.....#.#.....#...#.#...#.......#.#.#.#.#...#.#.#.#.....#...#.#.......#.#.#.#.#.#...#.....#.#      #.#.#####.###.###.###.###.###.#.#.#.###.#########.###.#######.#.#.###.###.#.#.#.#.#.###.###.###.#.#.#.#.#.#.###.#####.#      #.#...#.....#.........#.....#.#.#.....#.#...#.....#.......#.....#.......#.....#.#.#.#...#.....#.#.......#.#...#.#.....#      #.#.#####.#.#.###.###.#####.###.#.#.#####.#######.#.#######.#######.#.###.###.#####.#.###.#.#.#.###.#.###.#.###.#.###.#      #.#.......#.#.#.#.#.#...#.#.......#.#.#.....#.#...#.#.....#.....#...#.#...#...#...........#.#.#.#.#.#.#...#...#.....#.#      #.#.#.#########.###.#.###.#########.###.#.###.#.###.#.###.###.###.#.#####.###.#.#.#####.#.###.###.#.#####.#.#####.#####      #.#.#.#.......#.....#.#.....#...#.....#.#...#.#.#.#...#.#.#.....#.#.....#.#...#.#.#.#.#.#...#.....#...#...#.#...#.#.#.#      #.###.#.###########.#.#.###.###.#####.#.#.###.#.#.#.###.#.#.#####.###.#######.#.#.#.#.###########.#.#####.#.#.###.#.#.#      #...#.....#...#.#.#.....#.#.#.......#...#...#.....#...#...#.#...#.#.....#.#...#.#.#.....#.#.....#.#.......#...#...#...#      #.###.#.#####.#.#.###.#.#.#####.#.#######.###.###.#.###.###.#.#.###.#####.###.#.#.#.###.#.#####.#.#.#.###.#.#.###.#.###      #.#.#.#...#...#.......#.#.#.....#.........#.#.#...#.#...#.#...#...#.#...#...#.#.#...#.#.....#...#.#.#...#.#.#.........#      #.#.#.#######.#####.#.###.#######.#.#####.#.#.###.#.###.#.#######.#.#.#.#.###.#.#.#.#.#########.#####.#.#.#####.###.#.#      #.......#...#.#.#.#.#.....#.#...#.#.....#.#...#.#.#.#.....#.....#.#.#.#...#.....#.#.......#.#.......#.#.#.#...#.#...#.#      ###.#.###.###.#.#.#.#####.#.#.#.#.#####.#######.#.###.#.#.#.#.###.#.###.#####.###.###.###.#.#.#.#.#.#.#####.###.#####.#      #...#.#.........#.#.#...#.#...#...#.......#.........#.#.#.#.#.....#.........#.#...#...#...#...#.#.#.#...#.#...#...#.#.#      ###.#######.#.###.#.###.###########.###########.#########.#.#########.#########.###########.#####.#.###.#.#.###.###.###      #.......#.#.#...#.#...#.#.....#    N           E         R T         O         F        #.#...#...#.#.......#.#...#.#.#      #######.#.#####.#.#.###.#####.#    O           I         I T         O         Y        #.#.#########.###.###.#.###.#.#      #.#.......................#.#.#                                                         #.#.#.#.#...#.#.............#.#      #.#.#######.#####.#.#.#.###.#.#                                                         #.#.#.#.#.#.#####.#########.#.#    IP..#.....#.....#...#.#.#...#.#.#                                                         #.#...#.#.#...#.#.........#...#      #.#####.#.#.#.###.#######.#.#.#                                                         #.#.###.###.###.#####.#.#####.#      #.....#.#.#.#.#...#.........#..YL                                                     IH........#.#...#.#...#.#...#.#..CI    #.#####.#########.#########.#.#                                                         #.#####.#.#.#.#.#.#.###.###.#.#      #.......#...#.#.#.#.#.#.#.....#                                                         #.#.........#.....#.....#.#.#.#      #####.###.###.#.###.#.#.#######                                                         #####################.###.#.###      #.#.#.#.....#.....#.........#.#                                                         #.......#...........#.#.....#.#      #.#.###.#.#####.#######.###.#.#                                                         #.#####.#.#####.###.###.###.#.#    UI....#.#.#.#.#.....#.#.#...#...#                                                         #.#.#.#.....#.....#.#.....#....TB    #.###.###.#.###.###.#.###.###.#                                                         #.#.#.###.#########.###.#.#####      #.#...#.........#...#...#.#....UA                                                     UI........#...#...#.....#.#.....#      #.###.#####.###.#.###.#.#.#.###                                                         #.#######.###.#######.#######.#    AU............#.........#...#....FQ                                                       #.#...#.#...#.#...............#      ###.#.#.#.#.#####.#############                                                         #####.#.#####.###.#.#.#.#####.#    OO..#.#.#.#.#.#.#...#.......#...#                                                         #.#.....#.......#.#.#.#.#...#.#      #.#####.#####.###.#.#.#.###.#.#                                                         #.#.#.###.#.#.#######.###.###.#      #...#...#.#.#...#.#.#.#.....#.#                                                       TZ..#.#.#...#.#...#.#.#.#...#.#.#      #.###.#.#.#.#.#######.#######.#                                                         #.#.#.#.###.#####.#.#####.#.###      #...#.#.#.........#.....#.#....IP                                                       #...#.#...#...#.#.......#...#..UA    ###.#####.#####.#####.###.###.#                                                         #####.###.#.###.###.#.###.#.#.#      #.#.......#.#.#.......#.....#.#                                                         #.#.#.....#.........#.....#...#      #.#########.#.#############.###                                                         #.#.#########################.#      #...........#.........#.......#                                                       RL..#.......#...............#.#.#      #.###.#.###.#.#.#####.#.#####.#                                                         #.#.#####.###.#.###.#.###.#.###    FY..#...#.#.....#.#...#.....#....AU                                                       #.#...#.......#.#.#.#.#.#.....#      #.#########.#######.###########                                                         #.#.#######.#.###.#####.#.#.###      #...#.....#.#.#.......#.......#                                                         #.#.......#.#...#.#.....#.#.#..PH    #####.#######.#.#.#.###.#####.#                                                         #.#.#.###########.###.#.#.###.#      #.#...#.#...#.#.#.#...#...#....PS                                                       #...#.#.....#.#...#.#.#.#.....#      #.###.#.#.###.###.#.#.#.#.#####                                                         #######.#####.###.#.###.#######      #...#...#...#...#.#.#.#.#.....#                                                         #.....................#.......#      #.###.###.#.#.#.#.###.###.#####                                                         #.#####.###.#####.###.#.###.###    FQ..........#...#.....#.....#.#.#                                                       WL....#.....#.#.#...#...#.#...#..RL    #####################.###.#.#.#                                                         #.#####.###.#.#######.#.#.###.#    EI....#.#.#...#.......#.#.#.#.#.#                                                         #.#.#.....#.#...#.#.....#...#.#      ###.#.#.#.#.#.###.#####.###.#.#                                                         ###.#.#.#####.###.###.#####.#.#      #.........#.....#..............TP                                                       #.#.#.#.#.#.......#.#...#.....#      #.#.#########.#.#.#.#.###.###.#                                                         #.#.#####.###.#####.###########      #.#.#.....#...#.#.#.#.#...#.#.#                                                       CI....#.........#.#.....#...#.#.#      #####.###.###############.#.###                                                         ###.#.###.###.#.#.#.#####.#.#.#    RI....#.#.#.#.#.#.....#.#.#.#...#                                                         #...#.#...#.......#...#.#.#.#.#      #.###.#.#.#.#.#####.#.#.#####.#                                                         #.###.###.#####.#.###.#.#.#.#.#      #...#...#...#.#.#.#.#...#.#...#                                                         #.....#.#...#...#.#...........#      #.#####.###.#.#.#.#.#.###.#.#.#                                                         #.#.###.#.#######.#.#.#.#.#####    AA..........#.................#..KS                                                       #.#...#.....#.....#.#.#.#......ZS    #.###.###.#.###.#.###.###.###.#                                                         #.#.###.#####.###.#.###.###.###      #.#.....#.#.#.#.#...#.#.....#.#                                                         #.#...#.....#.#...#.#...#.....#      #.###.#####.#.#####.#########.#    T             Z     P         Z       E     B P      ###.#########.#.###.#.#####.#.#      #...#.....#.....#...#.........#    B             E     H         S       M     W W      #.#...#...#...#.#...#.#.#...#.#      #.#####.#.#.#.#####.###.###.#.#####.#############.#####.#########.#######.#####.#.#######.#.###.###########.###.###.###      #.....#.#.#.#...#...#.#.#...#...#.#.....#.....#.....#.....#.....#.#.....#.#.....#.......#.........#...............#...#      #.###.#.#.#.#.###.#.#.###########.###.###.#.#.###.#######.#.###.#.#.###.#.#.###.###.#########.#.#########.###.#.#.#.###      #.#.#.#.#.#.#...#.#...#.#.#...#.#.#...#.#.#.#.#.....#.....#.#.....#...#.#.#.#...#.....#...#.#.#.....#.#.....#.#.#.#...#      #.#.#.###.#######.#####.#.###.#.#.#.###.###.#.#.#######.###.#########.#.#.#.#####.#.###.###.#.###.###.#.###.#####.#.#.#      #...#.#...#...#.#...#.............#...#.....#.#...#.....#...#.....#...#...#.#.#.#.#.....#.#.#...#.....#...#.#.#...#.#.#      #.#.###.#.#.###.#######.###.#####.#.#######.#.#.###.#.#####.#.###.#.#######.#.#.###.#####.#.#######.###.#####.#######.#      #.#.#.#.#...........#...#...#.#.........#...#.....#.#.#.#.....#.#.#.......#...#.....#.....#.#.#...#.#.........#.#.....#      #.#.#.#####.#.#########.###.#.#####.#####.#.###.###.###.###.#.###.#######.###.###.#####.###.#.#.#########.#.###.#######      #.#.....#...#.#.#.........#.#.....#.....#.#...#.#.........#.#.#.#.#...#...#.....#...............#.#.....#.#.........#.#      #.#.#######.###.###.#############.#.#######.###.#######.#.#.###.#.#.#.#.###.#.#######.#.#####.###.#.#######.#.#.#.###.#      #.#.....#.......#.#.#.#.#.#.........#.........#.#.......#.#...#.#.#.#.....#.#.#.#.....#...#...#.#.#.....#.#.#.#.#...#.#      #.###.#######.###.###.#.#.#.#.###.#.#######.#######.#.#.###.#.#.#.#.#.#####.###.#.#.###.#####.#.#.#.#####.###.#######.#      #.#...#.#.....#.#.#.........#.#.#.#...#.......#.....#.#...#.#.#...#.#.#.........#.#.#.#.....#.......#.#.....#.#...#.#.#      #.#####.###.#.#.#.###.#.###.###.###.#######.#####.#.###.#######.###.#.#.###.#.#####.#.#######.#.###.#.#####.###.###.#.#      #.#.#.......#.#.......#.#...#.......#.........#...#...#.#...#.....#.#.#.#.#.#.#...........#...#.#...........#.#.......#      #.#.###.#########.###.#######.###.#.#####.#.#######.#####.#.#.#.###.#####.#.#########.#####.#.#.#######.#.###.#.#####.#      #.....#...#.......#.....#.....#.#.#.#.#.#.#.#.#...........#.#.#...#...#.....#...#.#.#.#...#.#.#.....#...#.......#...#.#      ###.#######.#.#####.#######.###.###.#.#.###.#.#######.#########.###.#####.#.#.###.#.#.#.#####.###.#.###############.###      #.....#.....#.#.....#.#.....#.#...#.#.#...#...#.#.....#...#...#...#...#.#.#.#.#.#.#.......#.#...#.#.#.#.............#.#      #.#########.#.#######.#######.###.#.###.#.#.###.###.###.#.###.#.#####.#.###.#.#.#.###.#.###.#####.#.#.#.#####.#####.#.#      #...#.......#.#.#.#...........#.........#.#.#.#.#.......#.#...#...#.......#.........#.#.........#.#.#.#...#.#...#.....#      #.#.#####.#.#.#.#.###########.###.#.#####.#.#.#.#######.###.#.###.###.#########.#####.#####.#########.#.###.#.#######.#      #.#.#.....#.#.#...................#.#.#...#.#.#...#.......#.#.......#.....#.....#...#.#.#.....#...........#.#.#.#.#.#.#      ###.###.#.#######.#.###.#########.###.#.#.#.###.#.#.#########.###.#####.###.#######.#.#.#####.#.#.#.#######.#.#.#.#.###      #.....#.#...#.....#.#.........#.#.#.#...#.#.#...#.#.#.....#.....#.#.......#.......#.....#...#...#.#.........#.........#      ###.###.###.#####.#############.###.#.#.###.#.###.#.#.#.#####.#####.#######.#######.#######.###.###########.###.###.###      #.#.#.#...#...#...#.#.#...#...#.......#.#.....#.#.#...#.#.......#...#.....#.#...#...........#.#.........#.#.#...#.....#      #.#.#.#.#.#.#######.#.###.#.###.#.###.###.#####.#.#####.#####.#####.###.#.#.#.#######.#####.#.#.#.#######.#.###.#.#.#.#      #...#...#.#...#.................#.#.....#.#...........#...#.......#.....#.#.......#.......#...#.#.......#.....#.#.#.#.#      ###################################.#######.###########.#######.#.#######.###.#######.#################################                                         N       Y           T       Z E       Z   T       I                                                                          O       L           P       Z M       E   T       H                                                                                                                                                                 ");